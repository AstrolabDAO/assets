/*! csv42 5.0.0 https://github.com/josdejong/csv42 @license MIT */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).csv42={})}(this,function(n){"use strict";function r(n,t){let e=n,r=0;for(;r<t.length&&void 0!==e;)e=e?.[t[r]],r++;return e}function i(n,t,e){let r=n;var o=t.length-1;let i=0;for(;i<o;){var u=t[i];void 0===r[u]&&("number"==typeof t[i+1]?r[u]=[]:r[u]={}),r=r[u],i++}return r[t[o]]=e,n}function c(n){return"object"==typeof n&&null!==n&&n.constructor===Object}function e(n){return n.map((n,t)=>"number"==typeof n?"["+n+"]":/[.\[\]]/.test(n)||""===n?'["'+n.replace(/"/g,'\\"')+'"]':(0<t?".":"")+n).join("")}function u(o){var n,t=[];let i=0;for(;i<o.length;)"."===o[i]&&i++,"["===o[i]?(i++,'"'===o[i]?(i++,t.push(e(n=>'"'===n,!0)),r('"')):(n=e(n=>"]"===n),t.push(n)),r("]")):t.push(e(n=>"."===n||"["===n));function e(n,t){var e=1<arguments.length&&void 0!==t&&t;let r="";for(;i<o.length&&!n(o[i]);)e&&"\\"===o[i]&&'"'===o[i+1]?(r+='"',i+=2):(r+=o[i],i++);return!e&&/^ *\d+ *$/.test(r)?parseInt(r):r}function r(n){if(o[i]!==n)throw new SyntaxError(`Invalid JSON path: ${n} expected at position `+i);i++}return t}function l(n,t){return o(n,t).map(n=>({name:e(n),getValue:function(t){if(1!==t.length)return n=>r(n,t);{const e=t[0];return n=>n[e]}}(n)}))}function d(n,t){return function(n){const r=new Set;return n.map(n=>{let t=n,e=0;for(;r.has(t);)e++,t=n+"_"+e;return r.add(t),t})}(n).map(e=>{const r=u(e),o=r[0];return{name:e,setValue:0!==r.length&&t?1===r.length?(n,t)=>n[o]=t:(n,t)=>i(n,r,t):(n,t)=>n[e]=t}})}const f=Symbol();function o(n,t){const e={};n.forEach(n=>{t(n)||c(n)?function n(t,e,r){for(const o in t){const i=t[o],u=e[o]||(e[o]=Array.isArray(i)?[]:{});r(i)?n(i,u,r):a(i,u)}}(n,e,t):a(n,e)});n=[];return function e(n,r,o){if(!0===n[f]||null===n[f]&&s(n))o.push(r);else if(Array.isArray(n))n.forEach((n,t)=>e(n,r.concat(t),o));else if(c(n))for(const t in n)e(n[t],r.concat(t),o)}(e,[],n),n}function a(n,t){void 0===t[f]&&(t[f]=null!=n||null)}function s(n){return 0===Object.keys(n).length}function h(n){const r=new RegExp("["+n+'"\r\n]'),o=/"/g;return function n(t){var e;return"string"==typeof t?(e=t,r.test(e)||0===e.length?`"${e.replaceAll(o,'""')}"`:e):"number"==typeof t||"boolean"==typeof t?t+"":null==t?"":n(JSON.stringify(t))}}function p(n,t){var e;if("-"<=n[0]&&n[0]<="9")return e=Number(n),isNaN(e)?n:e;if("true"===n)return!0;if("false"===n)return!1;if("null"===n)return null;if(0===n.length&&!t)return null;if("{"===n[0]||"["===n[0])try{return JSON.parse(n)}catch(n){}return n}function g(n){if(1!==n.length)throw new Error(`Invalid delimiter: must be a single character but is "${n}"`);return n}function y(n,t){return v(n,t)||m(n,t)}function v(n,t){return n.charCodeAt(t)===A}function m(n,t){return n.charCodeAt(t)===b&&n.charCodeAt(t+1)===A}const A=10,b=13;const w=/""/g;n.collectNestedPaths=o,n.createFormatValue=h,n.csv2json=function(r,n){const o=!1!==n?.header,i=g(n?.delimiter||",").charCodeAt(0),u=34;var t=n?.parseValue||p,e=[];let f=0;var a=function(){const e=[];l((n,t)=>{e.push(o?String(n):"Field "+t)},n=>n),o||(f=0);return e}();const c=n?.fields?function(n,t){var e,r=[];for(e of t){var o=void 0!==e.index?e.index:n.indexOf(e.name);if(-1===o)throw new Error(`Field "${e.name}" not found in the csv data`);if(r[o])throw new Error("Duplicate field for index "+o);r[o]=e}return r}(a,Array.isArray(n?.fields)?n?.fields:n?.fields(a)):d(a,!1!==n?.nested);for(;f<r.length;){const s={};l((n,t)=>{c[t]?.setValue(s,n)},t),e.push(s)}return e;function l(n,t){let e=0;for(;f<r.length&&!y(r,f);)n(function(n){var t=f;{if(r.charCodeAt(f)===u){do{for(f++;r.charCodeAt(f)===u&&r.charCodeAt(f+1)===u;)f+=2}while(f<r.length&&r.charCodeAt(f)!==u);if(r.charCodeAt(f)!==u)throw new Error('Unexpected end: end quote " missing');f++;var e=r.substring(t+1,f-1).replaceAll(w,'"');return n(e,!0)}for(;f<r.length&&r.charCodeAt(f)!==i&&!y(r,f);)f++;return n(r.substring(t,f),!1)}}(t),e),e++,r.charCodeAt(f)===i&&f++;v(r,f)?f++:m(r,f)&&(f+=2)}},n.getIn=r,n.isObject=c,n.isObjectOrArray=function(n){return c(n)||Array.isArray(n)},n.json2csv=function(t,n){var e=!1!==n?.header;const r=g(n?.delimiter||",");var o=function(n){if(y(n,0))return n;throw new Error('Invalid EOL character: choose "\\n" or "\\r\\n"')}(n?.eol||"\r\n"),i="function"==typeof n?.flatten?n?.flatten:!1===n?.flatten?()=>!1:c;const u=n?.fields?Array.isArray(n?.fields)?n?.fields:n?.fields(t):l(t,i),f=n?.formatValue||h(r);let a="";e&&(a+=u.map(n=>f(n.name)).join(r)+o);for(let n=0;n<t.length;n++)a+=function(t){return u.map(n=>f(n.getValue(t))).join(r)}(t[n])+o;return a},n.parsePath=u,n.parseValue=p,n.setIn=i,n.stringifyPath=e});
